YUI.add("gallery-yui-lightbox",function(b){var a=function(c){a.superclass.constructor.apply(this,arguments);};a.NAME="Lightbox";a.ATTRS={active:{value:null},description:{value:null},nav:{value:null},counter:{value:null},current:{value:null},total:{value:null},canvas:{value:null},canvasContent:{value:null},throbber:{value:null},throbbies:{value:null},throbTimer:{value:null},throbIndex:{value:0},mask:{value:null},maskOpacity:{value:null},gallery:{value:null},galleryIndex:{value:0},galleryArgs:{value:{}},winPadding:{value:30},duration:{value:0.2},easing:{value:"ease-out"},visible:{value:false},zIndex:{value:30000},destructible:{value:["iframe","swf"]},contentType:{value:null},imgRegex:{value:/\w*\.jpe?g|png|gif$/i},swfRegex:{value:/\w*\.swf(\?.*#?.*)?$/i},fileRegex:{value:/\w*\.\w{3,4}$/i},gradientRegex:{value:/progid:DXImageTransform\.Microsoft\.Gradient\(startColorstr='.*', endColorstr='.*'\)/i},ieFiltered:{value:".yui3-lightbox-button, .yui3-lightbox-counter"}};b.extend(a,b.Overlay,{boxify:function(d,c){this.fire("boxify",d,c);return this;},hide:function(){this.fire("hide");return this;},show:function(){this.fire("show");return this;},view:function(e,g,d){var c=e;if(b.Lang.isString(c)){c={url:e,text:g};if(d){for(var f in d){if(d.hasOwnProperty(f)){c[f]=d[f];}}}}this.fire("view",c);return this;},previous:function(){this.fire("previous",true);return this;},next:function(){this.fire("next",false);return this;},loadImage:function(c){c.image=true;c.contentType="image";this.fire("loadImage",c);return this;},loadIframe:function(c){c.iframe=true;c.contentType="iframe";this.fire("loadIframe",c);return this;},loadAJAX:function(c){c.contentType="ajax";this.fire("loadAJAX",c);return this;},loadSWF:function(c){c.swf=true;c.contentType="swf";c.flashAttrs=c.flashAttrs||{};c.flashAttrs.wmode=c.flashAttrs.wmode||"opaque";this.fire("loadSWF",c);return this;},loadNode:function(c){c.contentType="node";c.node=b.Lang.isString(c.node)?b.one(c.node):c.node;c.node=c.node.cloneNode(true);this.fire("loadNode",c);return this;},loadHTML:function(c){c.contentType="html";c.node=b.Node.create(c.html);this.fire("loadHTML",c);return this;},_boxify:function(f,d,c){d=b.Lang.isString(d)?b.all(d):d;d.addClass(this.getClassName("boxified"));d.on("click",this._handleBoxifiedClick,this,c);},_hide:function(g){var f=this,i=this.get("contentBox"),h=this.get("canvasContent"),c=this.get("mask"),d=function(){f._fade(i,0,function(){f.get("nav").setStyles({display:"none",opacity:0});if(f.get("contentType") in f.get("destructible")){h.empty();}f._fade(c,0,function(){f.set("visible",false);c.addClass(f.getClassName("hidden"));});});};if(b.UA.ie==8){this._fade(this.get("ieFiltered"),0,d);}else{d();}},_show:function(i){var h=this,k=this.get("contentBox"),l=this.get("mask"),c=this.get("nav"),d=this.get("active"),m=this.get("gallery"),f=this.get("duration"),j=this.get("easing"),g;if(this.get("visible")){return;}this.set("visible",true)._center();if(d&&m){g=m.indexOf(d);this.set("galleryIndex",g);this.get("current").setContent(g+1);this.get("total").setContent(m.size());c.setStyles({display:"block",opacity:1});this._clearFilter(c);}l.removeClass(h.getClassName("hidden"));this._fade(l,this.get("maskOpacity"),function(){k.setStyle("marginTop","-20px").transition({duration:f,easing:j,opacity:1,marginTop:0},function(){h._clearFilter(k);if(b.UA.ie==8){h._fade(h.get("ieFiltered"),1);}});});},_view:function(c){if(c.image||this.get("imgRegex").test(c.url)){this.loadImage(c);}else{if(c.swf||this.get("swfRegex").test(c.url)){this.loadSWF(c);}else{if(c.ajax){this.loadAJAX(c);}else{if(c.html){this.loadHTML(c);}else{if(c.node){this.loadNode(c);}else{this.loadIframe(c);}}}}}},_prevNext:function(g){var k=g.type.split(":")[1]=="previous"?-1:1,h=this.get("current"),m=this.get("gallery"),j=this.get("galleryArgs"),d=this.get("galleryIndex")+k,l=m.size(),c=this.get("duration"),i=this.get("easing"),f;if(d<0){d=l-1;}else{if(d>=l){d=0;}}f=m.item(d);this.set("galleryIndex",d);this._fade(this.get("counter"),0,function(){h.setContent(d+1);});j.url=this._getBestURL(f);j.text=this._getBestDescription(f);this.view(j);},_center:function(d,c){this._ieFooterFix();this.get("boundingBox").setStyle("marginLeft",this._getMargin("left")).setStyle("marginTop",this._getMargin("top"));return this;},_getMargin:function(c){if(b.Lang.isString(c)){var d=c=="left"?"offsetWidth":"offsetHeight";c=this.get("boundingBox").get(d);}return"-"+Math.round(c/2)+"px";},_getBestURL:function(c){if(c.get("href")){return c.get("href");}if(c.get("src")){return c.get("src");}},_getBestDescription:function(c){if(c.get("title")){return c.get("title");}if(c.get("alt")){return c.get("alt");}if(c.get("textContent")){return c.get("textContent");}if(c.get("innerText")){return c.get("innerText");}var d=c.get("href")||c.get("src");if(this.get("imgRegex").test(d)){return this.get("imgRegex").exec(d)[0];}if(this.get("fileRegex").test(d)){return this.get("fileRegex").exec(d)[0];}return d;},_loadContent:function(d){var c,e=function(g,f){if(d.ajax){d.node.setContent(f.responseText);}this.fire("load",d);};if(d.image){c="img";}else{if(d.iframe){c="iframe";}else{c="div";}}if(!d.node){d.node=b.Node.create("<"+c+">");if(c=="div"){d.node.setStyle("height","100%");}}this._showThrobber();this._fade(this.get("description"),0,function(){this.setContent(d.text);});this._fade(this.get("canvasContent"),0,function(){this.setContent(d.node);});if(d.image||d.iframe){d.node.on("load",e,this);d.node.set("src",d.url);}else{if(d.ajax){b.io(d.url,{on:{complete:e},context:this});}else{if(d.swf){new b.SWF(d.node,d.url,{version:d.flashVersion,fixedAttributes:d.flashAttrs,flashVars:d.flashVars});e.call(this);}else{e.call(this);}}}},_load:function(c){var d=this._calculateDimensions(c);this._resizeAndDisplay(d.nodeWidth,d.nodeHeight,d.cbWidth,d.cbHeight);},_calculateDimensions:function(f){var x=this.get("boundingBox"),m=this.get("contentBox"),g=this.get("canvas"),k=this.get("canvasContent"),q=this.get("counter"),c=this.get("duration"),t=this.get("easing"),i=f.node;
if(b.UA.ie==9){i=f.node.cloneNode(false);i.setStyles({position:"absolute",top:"-9999em",left:"-9999em"}).detach();b.one(document.body).append(i);}var u=parseInt(i.get("width"),10),r=parseInt(i.get("height"),10);if(b.UA.ie==9){i.remove();}var e=f.width||u,o=f.height||r,j=x.get("offsetWidth")-k.get("offsetWidth"),v=x.get("offsetHeight")-k.get("offsetHeight"),s=m.get("winWidth"),d=m.get("winHeight"),w=this.get("winPadding")*2,n=u/r,y,h,l,p;if(f.image){if(!f.height){o=parseInt(e/n,10);}else{if(!f.width){e=parseInt(o*n,10);}}}else{if(!e||!o){e=e||s-w-j;o=o||d-w-v;}}n=e/o;y=e+j;newCBHeight=o+v;l=y+w;p=newCBHeight+w;if(l>s){y=s-w;e=y-j;o=parseInt(e/n,10);newCBHeight=o+v;}else{if(p>d){newCBHeight=d-w;o=newCBHeight-v;e=parseInt(o*n,10);y=e+j;}}if(f.image||f.iframe||f.ajax){f.node.setStyle("width","100%").setStyle("height","100%");}this.set("contentType",f.contentType);return{nodeWidth:e,nodeHeight:o,cbWidth:y,cbHeight:newCBHeight};},_resizeAndDisplay:function(c,f,h,e){var d=this,g=this.get("duration"),i=this.get("easing");this.get("boundingBox").transition({duration:g,easing:i,marginLeft:d._getMargin(h),marginTop:d._getMargin(e)});canvas=this.get("canvas").transition({duration:g,easing:i,width:c+"px",height:f+"px"},function(){d._ieFooterFix();d._hideThrobber();d._fade([d.get("canvasContent"),d.get("description"),d.get("counter")],1);});},_showThrobber:function(){var c=this.get("throbber"),d=this.get("throbTimer");if(d){d.cancel();}this._throb();this.set("throbTimer",b.later(100,this,this._throb,null,true));c.removeClass(this.getClassName("hidden"));this._fade(c,1);this.show();},_hideThrobber:function(){var c=this,e=this.get("throbber"),d=this.getClassName("hidden");this._fade(e,0,function(){e.addClass(d);c.get("throbTimer").cancel();});},_throb:function(){var c=this.get("throbbies"),d=this.get("throbIndex")+1;fade=2;if(d>=c.size()+fade){d=-(fade);}this.set("throbIndex",d);c.each(function(f,e){var g=fade-Math.abs(d-e);if(g<0){g=0;}f.setStyle("padding",g+"px");});},_fade:function(f,c,g){var e=this;if(b.Lang.isArray(f)){for(var d=0;d<f.length;d++){this._fade(f[d],c,g);}return;}f.transition({duration:this.get("duration"),easing:this.get("easing"),opacity:c},function(){if(c===1){e._clearFilter(f);}if(g){g.call(f);}});},_clearFilter:function(e){var d=this,c=this.get("gradientRegex"),f;if(!b.UA.ie||b.UA.ie>8){return;}if(e.size){e.each(function(g){d._clearFilter(g);});return;}e=b.Node.getDOMNode(e);if(e.style.filter){f=c.exec(e.style.filter);e.style.filter=null;if(f){e.style.filter=f[0];}}},_handleButtonClick:function(h){var g=h.target.ancestor("."+this.getClassName("button"),true),c=this.getClassName(),f=new RegExp("button "+c+"-(.*)"),d=f.exec(g.get("className"))[1];switch(d){case"previous":this.previous();break;case"next":this.next();break;case"close":this.hide();break;}},_handleBoxifiedClick:function(i,g){var h=i.target.ancestor("."+this.getClassName("boxified"),true),c=i.target.get("rel"),d=c?b.all('*[rel="'+c+'"]'):null,f=g||{};i.preventDefault();if(d&&d.size()===1){d=null;}this.set("active",h).set("gallery",d).set("galleryArgs",f);f.url=this._getBestURL(h);f.text=this._getBestDescription(h);this.view(f);},_ieFooterFix:function(){if(b.UA.ie&b.UA.ie<8){this.getStdModNode(b.WidgetStdMod.FOOTER).setStyle("width",this.get("canvas").get("offsetWidth")+"px");}},__transitionFallback:function(c,e){for(var d in c){if(c.hasOwnProperty(d)&&d!="duration"&&d!="easing"){this.setStyle(d,c[d]);}}if(e){e();}},renderUI:function(){var j=this.get("contentBox"),h=this.getClassName(),g=b.one(document.body),l=b.Node.create('<div class="'+h+"-mask "+h+'-hidden"></div>'),d="",f,k,c;this.setStdModContent(b.WidgetStdMod.BODY,'				<div class="'+h+'-canvas">					<div class="'+h+'-canvas-content"></div>				</div>				<div class="'+h+"-throbber "+h+'-hidden"></div>			');f=j.one("."+h+"-throbber");for(var e=0;e<10;e++){d+="<div><span></span></div>";}f.append(d);this.set("throbbies",f.all("span"));this.setStdModContent(b.WidgetStdMod.FOOTER,'				<div class="'+h+'-nav">					<a class="'+h+"-button "+h+'-previous" href="javascript:void(0);" title="Previous"><span></span><span></span></a>					<span class="'+h+'-counter">						<span class="'+h+'-current"></span><span class="'+h+'-of">of</span><span class="'+h+'-total"></span>					</span>					<a class="'+h+"-button "+h+'-next" href="javascript:void(0);" title="Next"><span></span><span></span></a>				</div>				<div class="'+h+'-controls">					<a class="'+h+"-button "+h+'-close" href="javascript:void(0);" title="Close">x</a>				</div>				<p></p>			');g.append(l);this.set("mask",l).set("canvas",j.one("."+h+"-canvas")).set("canvasContent",j.one("."+h+"-canvas-content")).set("throbber",j.one("."+h+"-throbber"));k=this.getStdModNode(b.WidgetStdMod.FOOTER);c=k.one("."+h+"-nav");this.set("description",k.one("p")).set("nav",c).set("counter",c.one("."+h+"-counter")).set("current",c.one("."+h+"-current")).set("total",c.one("."+h+"-total"));if(b.UA.ie==8&&b.Lang.isString(this.get("ieFiltered"))){this.set("ieFiltered",j.all(this.get("ieFiltered")));}},bindUI:function(){var d=["show","hide","previous","next","boxify","view","loadImage","loadIframe","loadAJAX","loadSWF","loadNode","loadHTML","load"];for(var c=0,f,e;c<d.length;c++){f=d[c];if(f=="previous"||f=="next"){e="_prevNext";}else{if(f.match("load")&&f!="load"){e="_loadContent";}else{e="_"+f;}}this.publish(f,{defaultFn:this[e]});}this.get("contentBox").all("."+this.getClassName("button")).on("click",this._handleButtonClick,this);this.get("mask").on("click",this.hide,this);},syncUI:function(){var e,c=function(f){f.setStyle("opacity",0);};this.set("maskOpacity",this.get("mask").getStyle("opacity"));if(!this.get("visible")){e=[this.get("contentBox"),this.get("mask"),this.get("throbber"),this.get("nav")];if(b.UA.ie==8){e.push(this.get("ieFiltered"));}for(var d=0;d<e.length;d++){c(e[d]);}}},initializer:function(){var c=this.get("destructible"),e={};if(b.Lang.isArray(c)){for(var d=0;d<c.length;d++){e[c[d]]=true;}this.set("destructible",e);}if(!b.Transition){b.Node.prototype.transition=this.__transitionFallback;
b.NodeList.prototype.transition=this.__transitionFallback;}}});b.Lightbox=a;},"@VERSION@",{requires:["overlay"],optional:["transition","io-base","swf"]});